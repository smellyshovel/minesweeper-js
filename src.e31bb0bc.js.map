{"version":3,"sources":["cell.js","field.js","minesweeper.js","index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Cell","field","x","y","_image","Images","closed","isMined","value","isClosed","isFlagged","isDoubted","context","drawImage","bounds","left","top","size","game","isStarted","mineCells","neighbours","dispatch","openCell","cell","isRecursive","isOpened","image","forEach","neighbour","force","tempImage","open","flag","flaggedNeighbours","filter","length","draw","theme","val","currentImage","offsetX","canvas","width","props","offsetY","height","right","bottom","Math","min","Field","getContext","initCells","eventListeners","Map","registerEventListeners","cells","Array","from","c","i","xs","ys","includes","except","cellsToFill","minedCells","mines","random","push","find","isPaused","fillStyle","fillRect","textBaseline","textAlign","font","fillText","addEventListener","event","preventDefault","ignoreNextUp","set","target","locateCell","buttons","leftDown","middleDown","lastCell","button","leftUp","rightUp","middleUp","key","removeEventListener","clear","Minesweeper","Error","on","won","closedCells","every","lost","openedCells","some","flaggedCells","unregisterEventListeners","isEnded","listener","params","call","Settings","defaultPresets","easy","medium","hard","difficulty","localStorage","getItem","setItem","customPreset","JSON","parse","stringify","customWidth","customHeight","customMines","difficultyInput","document","querySelector","widthInput","heightInput","minesInput","updateInputs","disabled","updateMines","max","timerOutput","timer","time","startTimer","setInterval","outputTime","stopTimer","clearInterval","minutes","seconds","innerHTML","pauseButton","name","ImageSources","img","Image","src","startNewGame","resultOutput","flagsOutput","result","classList","add","setTimeout","remove","confirm","destroy","resume","pause","resizeCanvas","getBoundingClientRect","window","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","generated","js","console","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","getElementById","createElement","stackTrace","innerText","getParents","modules","parents","k","d","dep","isArray","concat","Function","deps","cached","cache","cb"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["export default class Cell {\n    constructor(field, x, y) {\n        this.field = field;\n\n        this.x = x;\n        this.y = y;\n\n        this._image = this.Images.closed;\n\n        this.isMined = false;\n        this.value = 0;\n\n        this.isClosed = true;\n        this.isFlagged = false;\n        this.isDoubted = false;\n    }\n\n    get Images() {\n        return this.field.theme;\n    }\n\n    set image(val) {\n        this._image = this.Images[`${ val }`];\n        this.draw();\n    }\n\n    set tempImage(val) {\n        let currentImage = this._image;\n        this.image = val;\n        this._image = currentImage;\n    }\n\n    get bounds() {\n        let offsetX = (this.field.canvas.width - this.field.props.width * this.size) / 2;\n        let offsetY = (this.field.canvas.height - this.field.props.height * this.size) / 2;\n\n        return {\n            left: this.x * this.size + offsetX,\n            right: this.x * this.size + this.size + offsetX,\n            top: this.y * this.size + offsetY,\n            bottom: this.y * this.size + this.size + offsetY\n        };\n    }\n\n    get size() {\n        return Math.min(\n            this.field.canvas.width / this.field.props.width,\n            this.field.canvas.height / this.field.props.height\n        );\n    }\n\n    get isOpened() {\n        return !this.isClosed;\n    }\n\n    draw() {\n        this.field.context.drawImage(\n            this._image,\n            this.bounds.left,\n            this.bounds.top,\n            this.size,\n            this.size\n        );\n    }\n\n    open() {\n        if (!this.field.game.isStarted) {\n            this.field.mineCells([this, ...this.neighbours]);\n            this.field.game.dispatch(\"start\", this.field.game);\n        }\n\n        (function openCell(cell, isRecursive) {\n            if (cell.isOpened || cell.isFlagged || cell.isDoubted) return;\n\n            if (cell.isMined) {\n                cell.isClosed = false;\n            } else {\n                cell.image = `${ cell.value }`;\n                cell.isClosed = false;\n\n                if (cell.value === 0) {\n                    cell.neighbours.forEach(neighbour => openCell(neighbour, true));\n                }\n            }\n\n            if (!isRecursive) {\n                cell.field.game.dispatch(\"cellopen\", cell);\n            }\n        })(this);\n    }\n\n    flag(force) {\n        if (this.isClosed) {\n            if (!this.isFlagged && !this.isDoubted) { // closed but not flagged nor doubted\n                this.isFlagged = true;\n                this.image = \"flag\";\n            } else if (this.isFlagged) { // already flagged\n                this.isFlagged = false;\n                this.isDoubted = true;\n                this.image = \"doubt\";\n            } else if (this.isDoubted) { // already doubted\n                this.isDoubted = false;\n                this.image = \"closed\";\n            }\n        }\n\n        if (force) {\n            this.isDoubted = false;\n            this.isFlagged = true;\n            this.image = \"flag\";\n        }\n\n        this.field.game.dispatch(\"cellflag\", this);\n    }\n\n    leftDown() {\n        if (this.isClosed && !this.isFlagged && !this.isDoubted) {\n            this.tempImage = \"0\";\n        }\n    }\n\n    leftUp() {\n        if (this.isClosed && !this.isFlagged && !this.isDoubted) {\n            this.open();\n        }\n    }\n\n    rightUp() {\n        this.flag();\n    }\n\n    middleDown() {\n        this.neighbours.forEach(neighbour => {\n            if (neighbour.isClosed && !neighbour.isFlagged && !neighbour.isDoubted) {\n                neighbour.tempImage = \"0\";\n            }\n        });\n    }\n\n    middleUp() {\n        if (this.isOpened && this.value) {\n            let flaggedNeighbours = this.neighbours.filter(neighbour => neighbour.isFlagged);\n\n            if (flaggedNeighbours.length === this.value) {\n                this.neighbours.forEach(neighbour => neighbour.open());\n            }\n        }\n\n        this.field.draw();\n    }\n}\n","import Cell from \"./cell\";\n\nexport default class Field {\n    constructor({ game, canvas, theme, ...props }) {\n        this.game = game;\n\n        this.canvas = canvas;\n        this.context = canvas.getContext(\"2d\");\n\n        this.theme = theme;\n\n        this.props = props;\n\n        this.initCells();\n\n        this.eventListeners = new Map();\n        this.registerEventListeners();\n\n        this.draw();\n    }\n\n    get closedCells() {\n        return this.cells.filter(cell => cell.isClosed);\n    }\n\n    get openedCells() {\n        return this.cells.filter(cell => cell.isOpened);\n    }\n\n    get flaggedCells() {\n        return this.cells.filter(cell => cell.isFlagged);\n    }\n\n    initCells() {\n        this.cells = Array.from(new Array(this.props.width * this.props.height), (c, i) => {\n            let x = i % this.props.width;\n            let y = (i - x) / this.props.width;\n\n            return new Cell(this, x, y);\n        });\n\n        this.cells.forEach(cell => {\n            cell.neighbours = this.cells.filter(neighbour => {\n                let xs = [cell.x - 1, cell.x, cell.x + 1];\n                let ys = [cell.y - 1, cell.y, cell.y + 1];\n\n                return xs.includes(neighbour.x)\n                    && ys.includes(neighbour.y)\n                    && cell !== neighbour;\n            });\n        });\n    }\n\n    mineCells(except) {\n        let cellsToFill = this.cells.filter(cell => !except.includes(cell));\n        this.minedCells = [];\n\n        while (this.minedCells.length < this.props.mines) {\n            let cell = cellsToFill[Math.random() * cellsToFill.length | 0];\n\n            if (!cell.isMined) {\n                cell.isMined = true;\n                this.minedCells.push(cell);\n            }\n        }\n\n        this.minedCells.forEach(cell => {\n            cell.neighbours.forEach(neighbour => neighbour.value += 1);\n        });\n    }\n\n    locateCell(offsetX, offsetY) {\n        return this.cells.find(cell => {\n            return cell.bounds.left <= offsetX\n                && cell.bounds.right >= offsetX\n                && cell.bounds.top <= offsetY\n                && cell.bounds.bottom >= offsetY;\n        });\n    }\n\n    draw() {\n        if (this.game.isPaused) {\n            this.context.fillStyle = \"#f2f2f2\";\n            this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n            this.context.textBaseline = 'middle';\n            this.context.textAlign = \"center\";\n            this.context.font = `2em Helvetica`;\n            this.context.fillStyle = \"#828282\";\n            this.context.fillText(\"The game is paused.\", this.canvas.width / 2, this.canvas.height / 2);\n        } else {\n            this.context.fillStyle = \"#fff\";\n            this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n            this.cells.forEach(cell => cell.draw());\n        }\n    }\n\n    registerEventListeners() {\n        // no need to ever unregister it\n        this.canvas.addEventListener(\"contextmenu\", (event) => {\n            event.preventDefault();\n        });\n\n        let ignoreNextUp = false;\n\n        this.eventListeners.set(\n            {\n                event: \"mousedown\",\n                target: this.canvas\n            },\n\n            (event) => {\n                // force draw to insure the latest state is visible\n                this.draw();\n\n                let cell = this.locateCell(event.offsetX, event.offsetY);\n                if (!cell) return;\n\n                if (event.buttons === 1) { // left button\n                    cell.leftDown();\n                } else if (event.buttons > 2 && event.buttons < 8) { // middle or both left and right buttons\n                    cell.middleDown();\n                }\n\n                ignoreNextUp = false;\n            }\n        );\n\n        // the last mousemove'd cell\n        let lastCell;\n\n        this.eventListeners.set(\n            {\n                event: \"mousemove\",\n                target: this.canvas\n            },\n\n            (event) => {\n                let cell = this.locateCell(event.offsetX, event.offsetY);\n                if (!cell) return;\n\n                if (lastCell !== cell) {\n                    // force draw to insure the latest state is visible\n                    this.draw();\n\n                    if (event.buttons === 1) { // left button\n                        cell.leftDown();\n                    } else if (event.buttons > 2 && event.buttons < 8) { // middle or both left and right buttons\n                        cell.middleDown();\n                    }\n\n                    lastCell = cell;\n                }\n            }\n        );\n\n        this.eventListeners.set(\n            {\n                event: \"mouseleave\",\n                target: this.canvas\n            },\n\n            (event) => {\n                this.draw();\n                ignoreNextUp = false;\n            }\n        );\n\n        this.eventListeners.set(\n            {\n                event: \"mouseup\",\n                target: this.canvas\n            },\n\n            (event) => {\n                let cell = this.locateCell(event.offsetX, event.offsetY);\n                if (!cell) return;\n\n                if (event.buttons === 0) { // no more buttons are down\n                    if (event.button === 0) { // left button\n                        if (!ignoreNextUp) cell.leftUp();\n                    } else if (event.button === 2) { // right button\n                        if (!ignoreNextUp) cell.rightUp();\n                    } else if (event.button === 1) { // middle button\n                        cell.middleUp();\n                        ignoreNextUp = true;\n                    }\n                } else if (event.buttons > 0 && event.buttons < 8) { // either left or right button is still down\n                    cell.middleUp();\n                    ignoreNextUp = true;\n                }\n            }\n        );\n\n        this.eventListeners.forEach((val, key) => {\n            key.target.addEventListener(key.event, val);\n        });\n    }\n\n    unregisterEventListeners() {\n        this.eventListeners.forEach((val, key) => {\n            key.target.removeEventListener(key.event, val);\n        });\n\n        this.eventListeners.clear();\n    }\n}\n","import Field from \"./field\";\n\nexport default class Minesweeper {\n    constructor({\n        canvas, // a <canvas> DOM element,\n        theme, // a set of images\n        width = 9, // number of cells by the X axis\n        height = 9, // number of cells by the Y axis\n        mines = 10 // number of mines on the field\n    }) {\n        if (width < 5 || width > 50 || height < 5 || height > 50) {\n            throw new Error(`Incorrect field size. The field must be from 5×5 to 50×50 cells large, but ${ width }×${ height } is provided`);\n        }\n\n        if (mines < 1 || mines > width * height - 10) {\n            throw new Error(`Incorrect number of mines. For the ${ width }×${ height } field it must be between 1 and ${ width * height - 10 }, but ${ mines } is provided`);\n        }\n\n        // all the event listeners registered using `.on()` are stored here\n        this.eventListeners = {};\n\n        this.field = new Field({\n            game: this,\n            canvas,\n            theme,\n            width,\n            height,\n            mines\n        });\n\n        this\n        .on(\"start\", () => {\n            this.isStarted = true;\n        })\n        .on(\"cellopen\", (cell) => {\n            let won = this.field.closedCells.every(cell => cell.isMined);\n            let lost = this.field.openedCells.some(cell => cell.isMined);\n\n            if (won) {\n                this.field.minedCells.forEach(cell => cell.flag(true));\n                this.dispatch(\"end\", \"won\");\n            } else if (lost) {\n                this.field.minedCells.forEach(cell => {\n                    if (!cell.isFlagged) cell.image = \"mine\";\n                });\n\n                this.field.flaggedCells.forEach(cell => {\n                    if (!cell.isMined) cell.image = \"cross\";\n                });\n\n                cell.image = \"trigger\";\n                this.dispatch(\"end\", \"lost\");\n            }\n        })\n        .on(\"pause\", () => {\n            this.isPaused = true;\n            this.field.draw();\n            this.field.unregisterEventListeners();\n        })\n        .on(\"resume\", () => {\n            this.isPaused = false;\n            this.field.draw();\n            this.field.registerEventListeners();\n        })\n        .on(\"end\", () => {\n            this.isEnded = true;\n            this.field.unregisterEventListeners();\n        });\n    }\n\n    pause() {\n        this.dispatch(\"pause\");\n    }\n\n    resume() {\n        this.dispatch(\"resume\");\n    }\n\n    on(event, listener) {\n        if (!this.eventListeners[event]) this.eventListeners[event] = [];\n        this.eventListeners[event].push(listener);\n\n        return this;\n    }\n\n    dispatch(event, ...params) {\n        (this.eventListeners[event] || []).forEach(listener => {\n            if (typeof listener === \"function\") {\n                listener.call(this, ...params);\n            }\n        });\n    }\n\n    destroy() {\n        this.dispatch(\"end\");\n        return null;\n    }\n}\n","const Settings = {\n    get defaultPresets() {\n        return {\n            easy: {\n                width: 9,\n                height: 9,\n                mines: 10\n            },\n\n            medium: {\n                width: 16,\n                height: 16,\n                mines: 40\n            },\n\n            hard: {\n                width: 30,\n                height: 16,\n                mines: 99\n            }\n        };\n    },\n\n    get difficulty() {\n        return localStorage.getItem(\"difficulty\");\n    },\n\n    set difficulty(val) {\n        localStorage.setItem(\"difficulty\", val);\n    },\n\n    get customPreset() {\n        return JSON.parse(localStorage.getItem(\"customPreset\"));\n    },\n\n    set customPreset(val) {\n        localStorage.setItem(\"customPreset\", JSON.stringify(val));\n    },\n\n    set customWidth(val) {\n        let customPreset = this.customPreset;\n        customPreset.width = val;\n        this.customPreset = customPreset;\n    },\n\n    set customHeight(val) {\n        let customPreset = this.customPreset;\n        customPreset.height = val;\n        this.customPreset = customPreset;\n    },\n\n    set customMines(val) {\n        let customPreset = this.customPreset;\n        customPreset.mines = val;\n        this.customPreset = customPreset;\n    },\n\n    get width() {\n        if (this.difficulty !== \"custom\") {\n            return +this.defaultPresets[this.difficulty].width;\n        } else {\n            return +this.customPreset.width;\n        }\n    },\n\n    get height() {\n        if (this.difficulty !== \"custom\") {\n            return +this.defaultPresets[this.difficulty].height;\n        } else {\n            return +this.customPreset.height;\n        }\n    },\n\n    get mines() {\n        if (this.difficulty !== \"custom\") {\n            return +this.defaultPresets[this.difficulty].mines;\n        } else {\n            return +this.customPreset.mines;\n        }\n    }\n}\n\nif (!Settings.difficulty) {\n    Settings.difficulty = \"medium\";\n}\n\nif (!Settings.customPreset) {\n    Settings.customPreset = {\n        width: 20,\n        height: 20,\n        mines: 20\n    }\n}\n\nlet difficultyInput = document.querySelector(\"#difficulty\");\nlet widthInput = document.querySelector(\"#width\");\nlet heightInput = document.querySelector(\"#height\");\nlet minesInput = document.querySelector(\"#mines\");\n\ndifficultyInput.value = Settings.difficulty;\n\nfunction updateInputs() {\n    widthInput.value = Settings.width;\n    heightInput.value = Settings.height;\n    minesInput.value = Settings.mines;\n\n    if (Settings.difficulty !== \"custom\") {\n        widthInput.disabled = true;\n        heightInput.disabled = true;\n        minesInput.disabled = true;\n    } else {\n        widthInput.disabled = false;\n        heightInput.disabled = false;\n        minesInput.disabled = false;\n    }\n}\n\nupdateInputs();\n\nfunction updateMines() {\n    minesInput.max = Settings.width * Settings.height - 10;\n\n    if (+minesInput.value > +minesInput.max) {\n        minesInput.value = minesInput.max;\n    }\n\n    Settings.customMines = minesInput.value;\n}\n\nupdateMines();\n\ndifficultyInput.addEventListener(\"change\", function() {\n    Settings.difficulty = this.value;\n    updateInputs();\n});\n\nwidthInput.addEventListener(\"change\", function() {\n    Settings.customWidth = this.value;\n    updateMines();\n});\n\nheightInput.addEventListener(\"change\", function() {\n    Settings.customHeight = this.value;\n    updateMines();\n});\n\nminesInput.addEventListener(\"change\", function() {\n    updateMines();\n});\n\nimport Minesweeper from \"./minesweeper\";\n\nlet timerOutput = document.querySelector(\"#timer\");\ntimerOutput.value = \"00:00\";\n\nlet timer, time = 0;\n\nfunction startTimer() {\n    timer = setInterval(function() {\n        time += 1;\n        outputTime();\n        // clock =\n    }, 1000);\n}\n\nfunction stopTimer(clear) {\n    clearInterval(timer);\n    if (clear) time = 0, outputTime();\n}\n\nfunction outputTime() {\n    let minutes = time / 60 | 0;\n    let seconds = time % 60;\n\n    timerOutput.innerHTML = `${ minutes < 10 ? `${ \"0\" + minutes }` : minutes }:${ seconds < 10 ? `${ \"0\" + seconds }` : seconds }`;\n}\n\nlet pauseButton = document.querySelector(\"#pause\");\n\nimport ImageSources from \"./assets/cells/*.svg\";\nconst Images = {};\n\nfor (let name in ImageSources) {\n    let img = new Image();\n    img.src = ImageSources[name];\n\n    Images[name] = img;\n}\n\nlet game = startNewGame();\n\nfunction startNewGame() {\n    let game = new Minesweeper({\n        canvas: document.querySelector(\"#minesweeper\"),\n        theme: {\n            ...Images\n        },\n        width: Settings.width,\n        height: Settings.height,\n        mines: Settings.mines\n    });\n\n    let resultOutput = document.querySelector(\"#result\");\n    resultOutput.value = \"\";\n\n    let flagsOutput = document.querySelector(\"#flags\");\n    flagsOutput.value = `0 / ${ Settings.mines }`;\n\n    game\n    .on(\"start\", function() {\n        startTimer();\n        pauseButton.disabled = false;\n    })\n    .on(\"pause\", function() {\n        stopTimer();\n        pauseButton.innerHTML = \"Resume\";\n    })\n    .on(\"resume\", function() {\n        startTimer();\n        pauseButton.innerHTML = \"Pause\";\n    })\n    .on(\"cellflag\", function() {\n        flagsOutput.value = `${ game.field.flaggedCells.length } / ${ Settings.mines }`;\n    })\n    .on(\"end\", function(result) {\n        if (result === \"won\") {\n            resultOutput.value = \"You won! Congratulations!\";\n            resultOutput.classList.add(\"visible\");\n        } else if (result === \"lost\") {\n            resultOutput.value = \"You lost :(\";\n            resultOutput.classList.add(\"visible\");\n        }\n\n        setTimeout(() => {\n            resultOutput.classList.remove(\"visible\");\n        }, 2000);\n\n        pauseButton.disabled = true;\n\n        stopTimer();\n    });\n\n    return game;\n};\n\ndocument.querySelector(\"#start\").addEventListener(\"click\", function() {\n    if (game.isStarted && !game.isEnded && !confirm(\"Are you sure?\")) return;\n\n    game = game.destroy();\n    game = startNewGame();\n\n    stopTimer(true);\n});\n\npauseButton.addEventListener(\"click\", function() {\n    if (game.isPaused) {\n        game.resume();\n    } else {\n        game.pause();\n    }\n});\n\nfunction resizeCanvas() {\n    let canvas = document.querySelector(\"#minesweeper\");\n    canvas.width = canvas.getBoundingClientRect().width;\n    canvas.height = canvas.getBoundingClientRect().height;\n    game.field.draw();\n}\n\nresizeCanvas();\n\nwindow.addEventListener(\"resize\", function(event) {\n    resizeCanvas();\n});\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}